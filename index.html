<canvas id="canvas" width="100" height="100"></canvas>


<script>

    let a = Array(10000).fill(0)
    a[(50-1)*100 + 50] = 1 // center pixel

    var canvas = document.getElementById('canvas');
    var ctx = canvas.getContext('2d');
    ctx.fillRect(50,50,1,1)
    console.log("ran script")
    let borders = [0,0,0,0]
    let bordercolor = ["#FF0000", "#00FF00", "#0000FF", "#FFFF00"]
    
    
    for(var i=0; i < 300; i++){
        //console.log("random walk iteration " + i)
        randomWalk();
    }
    console.log("summary borders start: " + borders)
    
    function randomWalk() {

        let xmax = 99
        let ymax = 99
        let x, y
        //choose random border starting place
        let border = Math.floor(Math.random() * 4)
        //if (border == 0) {    console.log("border is 0")}
        //console.log("border : " + border)
        // 0 is left border, 1 riht border, 2 top border, 3 bottom 
        let start = Math.floor(Math.random() * 100)
        if (border == 0 || border == 1) { // left/right
          y = start
          x = border == 0 ? 0 : 99 
        } else { //top-bottom 
            x = start
            y = border == 2 ? 0 : 99
        }
        borders[border]++

        //console.log ("starting pos: " + x + " , " + y)
        let count = 0
        

        while (a[100*(x) + y] == 0 ) { //not filled
            //if (border == 0) {
            //    console.log("Tracing start from border 0, now at " + x + ", " + y)
            //}
            count++
            //if (count > 200) {     return}
            //move 1 step. if finds a neighbor, save and draw else continue
            let xd
            let xoff = x - 50 > 0 ? 1 : -1
            xd = Math.random() < 0.52 ? -xoff : xoff // move towards center with prob 0.7

            x += xd
            x = Math.max(0, x)
            x = Math.min(99, x)
            if (checkNeighbors(x, y)) {
                //if (border == 0) {   console.log("found neighbor starting from border 0, is now at " + x + ", " + y)}
                a[100*(x-1) + y] = 1
                ctx.fillStyle = bordercolor[border]
                ctx.fillRect(x,y,1,1)
                return
            }
            let yd
            let yoff = y - 50 > 0 ? 1 : -1
            yd = Math.random() < 0.52 ? -yoff : yoff

            y += yd
            y = Math.max(0, y)
            y = Math.min(99, y)

            //console.log("inner loop " + count + "  position " + x + " , " + y)
            //check neighbors and if one is filled, fill this one and be done
            if (checkNeighbors(x, y)) {
                //if (border == 0) {   console.log("found neighbor starting from border 0, is now at " + x + ", " + y)}
                a[100*(x-1) + y] = 1
                ctx.fillStyle = bordercolor[border]
                ctx.fillRect(x,y,1,1)
                return
            }
   
        }

    }
    
    function checkNeighbors(x, y) {
        orig = [x, y]
        o1 = [x-1, y]
        o2 = [x+1, y]

        o3 = [x, y-1]
        o4 = [x, y+1]

        o5 = [x-1, y-1]
        o6 = [x-1, y+1]

        o7 = [x+1, y-1]
        o8 = [x+1, y+1]

        all = [o1, o2, o3, o4]//, o5, o6, o7, o8]
        //console.log("all: " + all)
        

        let valid = all.filter(o => {
            return o[0] < 100 && o[1] < 100 && o[0] >= 0 && o[1] >= 0
        })
        //console.log("valid: " + valid)
        let ret = 0;
        valid.forEach(v => {
            if (a[ 100 * (v[0]-1) + v[1]] == 1) {
                ret = 1
            }
        })
        return ret
    }
    
</script>
